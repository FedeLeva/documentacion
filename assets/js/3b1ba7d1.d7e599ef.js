"use strict";(self.webpackChunkdocumentacion=self.webpackChunkdocumentacion||[]).push([[907],{3905:(e,a,n)=>{n.d(a,{Zo:()=>d,kt:()=>m});var s=n(7294);function t(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function l(e,a){if(null==e)return{};var n,s,t=function(e,a){if(null==e)return{};var n,s,t={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var i=s.createContext({}),c=function(e){var a=s.useContext(i),n=a;return e&&(n="function"==typeof e?e(a):r(r({},a),e)),n},d=function(e){var a=c(e.components);return s.createElement(i.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return s.createElement(s.Fragment,{},a)}},p=s.forwardRef((function(e,a){var n=e.components,t=e.mdxType,o=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=t,v=p["".concat(i,".").concat(m)]||p[m]||u[m]||o;return n?s.createElement(v,r(r({ref:a},d),{},{components:n})):s.createElement(v,r({ref:a},d))}));function m(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var o=n.length,r=new Array(o);r[0]=p;var l={};for(var i in a)hasOwnProperty.call(a,i)&&(l[i]=a[i]);l.originalType=e,l.mdxType="string"==typeof e?e:t,r[1]=l;for(var c=2;c<o;c++)r[c]=n[c];return s.createElement.apply(null,r)}return s.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1531:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var s=n(7462),t=(n(7294),n(3905));const o={sidebar_position:8},r="SubConsultas",l={unversionedId:"SQL/subconsulta",id:"SQL/subconsulta",title:"SubConsultas",description:"Es posible que haya notado que incluso con una consulta completa, hay muchas preguntas que no podemos responder sobre nuestros datos sin una consulta adicional o un procesamiento previo. En estos casos, puede realizar varias consultas y procesar los datos usted mismo, o puede crear una consulta m\xe1s compleja utilizando subconsultas SQL.",source:"@site/docs/SQL/subconsulta.md",sourceDirName:"SQL",slug:"/SQL/subconsulta",permalink:"/documentacion/docs/SQL/subconsulta",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/SQL/subconsulta.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"SQL",previous:{title:"Manipulacion de tablas",permalink:"/documentacion/docs/SQL/modificar"}},i={},c=[{value:"Subconsultas correlacionadas",id:"subconsultas-correlacionadas",level:2},{value:"Pruebas de existencia",id:"pruebas-de-existencia",level:2}],d={toc:c};function u(e){let{components:a,...n}=e;return(0,t.kt)("wrapper",(0,s.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"subconsultas"},"SubConsultas"),(0,t.kt)("p",null,"Es posible que haya notado que incluso con una consulta completa, hay muchas preguntas que no podemos responder sobre nuestros datos sin una consulta adicional o un procesamiento previo. En estos casos, puede realizar varias consultas y procesar los datos usted mismo, o puede crear una consulta m\xe1s compleja utilizando subconsultas SQL."),(0,t.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,t.kt)("div",{parentName:"div",className:"admonition-heading"},(0,t.kt)("h5",{parentName:"div"},(0,t.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,t.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,t.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Ejemplo ")),(0,t.kt)("div",{parentName:"div",className:"admonition-content"},(0,t.kt)("p",{parentName:"div"},"Supongamos que su empresa tiene una lista de todos los asociados de ventas, con datos sobre los ingresos que genera cada asociado y su salario individual. Los tiempos son ajustados y ahora desea saber cu\xe1les de sus Asociados le est\xe1n costando a la empresa m\xe1s que el ingreso promedio generado por Asociado."))),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"Calcular los ingresos promedio que est\xe1n generando todos los Asociados.")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT AVG(revenue_generated)\nFROM sales_associates;\n\n")),(0,t.kt)("ol",{start:2},(0,t.kt)("li",{parentName:"ol"},"Luego , usando ese resultado , podemos comparar los costos de cada uno de los Asociados con ese valor. Para usarlo como una subconsulta, podemos escribirlo directamente en la cl\xe1usula  WHERE de la consulta:")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT *\nFROM sales_associates\nWHERE salary > \n   (SELECT AVG(revenue_generated)\n    FROM sales_associates);\n\n")),(0,t.kt)("p",null,"A medida que se ejecuta la restricci\xf3n, el salario de cada Asociado se comparar\xe1 con el valor consultado de la subconsulta interna."),(0,t.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,t.kt)("div",{parentName:"div",className:"admonition-heading"},(0,t.kt)("h5",{parentName:"div"},(0,t.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,t.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,t.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Parentesis()")),(0,t.kt)("div",{parentName:"div",className:"admonition-content"},(0,t.kt)("p",{parentName:"div"},"Se puede hacer una subconsulta en cualquier lugar (AVERIGUALO) "),(0,t.kt)("p",{parentName:"div"},"Debido a que las subconsultas se pueden anidar, cada subconsulta debe estar completamente encerrada entre par\xe9ntesis para establecer la jerarqu\xeda adecuada. De lo contrario, las subconsultas pueden hacer referencia a cualquier tabla en la base de datos y hacer uso de las construcciones de una consulta normal (aunque algunas implementaciones no permiten que las subconsultas usen LIMIT o OFFSET)."))),(0,t.kt)("h2",{id:"subconsultas-correlacionadas"},"Subconsultas correlacionadas"),(0,t.kt)("p",null,"Un tipo de subconsulta m\xe1s potente es la subconsulta correlacionada en la que la consulta interna depende de una columna o alias de la consulta externa. A diferencia de las subconsultas anteriores, cada una de estas consultas internas debe ejecutarse para cada una de las filas de la consulta externa, ya que la consulta interna depende de la fila de consulta externa actual."),(0,t.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,t.kt)("div",{parentName:"div",className:"admonition-heading"},(0,t.kt)("h5",{parentName:"div"},(0,t.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,t.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,t.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Ejemplo")),(0,t.kt)("div",{parentName:"div",className:"admonition-content"},(0,t.kt)("p",{parentName:"div"},"En lugar de la lista de Asociados de ventas anterior, imag\xednese si tiene una lista general de Empleados, sus departamentos (ingenier\xeda, ventas, etc.), ingresos y salario. Esta vez, ahora est\xe1 buscando en toda la empresa para encontrar empleados que se desempe\xf1en mejor (mas salario) que el promedio en su departamento."))),(0,t.kt)("p",null,"Para cada empleado, necesitar\xeda calcular su costo en relaci\xf3n con los ingresos promedio generados por todas las personas en su departamento. Para tomar el promedio del departamento, la subconsulta deber\xe1 saber en qu\xe9 departamento se encuentra cada empleado:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT *\nFROM employees\nWHERE salary > \n   (SELECT AVG(revenue_generated)\n    FROM employees AS dept_employees\n    WHERE dept_employees.department = employees.department);\n\n")),(0,t.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,t.kt)("div",{parentName:"div",className:"admonition-heading"},(0,t.kt)("h5",{parentName:"div"},(0,t.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,t.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,t.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,t.kt)("div",{parentName:"div",className:"admonition-content"},(0,t.kt)("p",{parentName:"div"},"Este tipo de consultas complejas pueden ser poderosas, pero tambi\xe9n dif\xedciles de leer y comprender, por lo que debe tener cuidado al usarlas. Si es posible, intente dar alias significativos a las tablas y valores temporales. Adem\xe1s, las subconsultas correlacionadas pueden ser dif\xedciles de optimizar, por lo que las caracter\xedsticas de rendimiento pueden variar entre diferentes bases de datos."))),(0,t.kt)("h2",{id:"pruebas-de-existencia"},"Pruebas de existencia"),(0,t.kt)("p",null,"El operador IN se usa para probar si el valor de la columna en la fila actual exist\xeda en una lista fija de valores. En consultas complejas, esto se puede ampliar utilizando subconsultas para probar si un valor de columna existe en una lista din\xe1mica de valores."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT *, \u2026\nFROM mytable\nWHERE column\n    IN/NOT IN (SELECT another_column\n               FROM another_table);\n\n")),(0,t.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,t.kt)("div",{parentName:"div",className:"admonition-heading"},(0,t.kt)("h5",{parentName:"div"},(0,t.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,t.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,t.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,t.kt)("div",{parentName:"div",className:"admonition-content"},(0,t.kt)("p",{parentName:"div"},"Al hacer esto, observe que la subconsulta interna debe seleccionar los valores de la columna  o los valores de una expresi\xf3n para producir una lista con la que se pueda probar el valor de la columna externa. Este tipo de restricci\xf3n es de gran alcance cuando las restricciones se basan en datos actuales."))))}u.isMDXComponent=!0}}]);